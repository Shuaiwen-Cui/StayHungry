-> [English](/DEVENV/IDE/C_CPP/c_cpp.md)

# C/C++
## IDE / ç¼–è¾‘å™¨
- VSCode
  - PlatformIO
- Visual Studio
- Keil
- Eclipse
- IntelliJ IDEA

## æ„å»ºç³»ç»Ÿ
> ä» gcc åˆ° cmake

[ğŸ”— GCCã€CMakeã€CMakelistã€Makeã€Makefileã€Ninjaå•¥å…³ç³»ï¼Ÿä¸€å›¾è®²é€ï¼](https://zhuanlan.zhihu.com/p/659841728)

- gcc
  - gcc æ˜¯ä¸€ä¸ªç¼–è¯‘å™¨
- make & makefile
  - make æ˜¯ä¸€ä¸ªæ„å»ºç³»ç»Ÿï¼Œç”¨äºæ„å»ºé¡¹ç›®ã€‚make æ„å»ºåœ¨ gcc ä¹‹ä¸Šã€‚makefile æ˜¯ make çš„é…ç½®æ–‡ä»¶ã€‚
- cmake & CMakeLists.txt
  - cmake æ˜¯ä¸€ä¸ªæ„å»ºç³»ç»Ÿï¼Œç”¨äºæ„å»ºé¡¹ç›®ã€‚cmake æ„å»ºåœ¨ make ä¹‹ä¸Šã€‚CMakeLists.txt æ˜¯ cmake çš„é…ç½®æ–‡ä»¶ã€‚
- ninja
  - ninja æ˜¯ä¸€ä¸ªæ„å»ºç³»ç»Ÿï¼Œç”¨äºæ„å»ºé¡¹ç›®ã€‚ninja æ„å»ºåœ¨ cmake ä¹‹ä¸Šã€‚ninja æ˜¯ cmake çš„æ›¿ä»£å“ï¼Œå› ä¸º ninja æ„å»ºé€Ÿåº¦æ›´å¿«ã€‚
- xmake
  - xmake æ˜¯ä¸€ä¸ªæ„å»ºç³»ç»Ÿï¼Œç”¨äºæ„å»ºé¡¹ç›®ã€‚xmake çš„ç‰¹ç‚¹æ˜¯ç®€å•æ˜“ç”¨ï¼Œä¸”è·¨å¹³å°ã€‚xmake æ„å»ºåœ¨ ninja ä¹‹ä¸Šã€‚xmake æ˜¯ ninja çš„æ›¿ä»£å“ï¼Œå› ä¸º xmake æ›´ç®€å•æ˜“ç”¨ã€‚æ³¨æ„ï¼Œxmakeèµ·æ­¥æ™šï¼Œå°šæœªç»è¿‡å¤§è§„æ¨¡éªŒè¯ï¼Œå› æ­¤åœ¨å¤§å‹é¡¹ç›®ä¸­ä½¿ç”¨æ—¶éœ€è¦è°¨æ…ã€‚

### GCC

** KEY COMMANDS TO REMEMBER **

> ç®€å•ç”¨æ³•

```bash
gcc <srcfilename>.c

// then run

./a.out

```

> æ­£å¸¸ç”¨æ³•


```bash
gcc <srcfilename>.c -o <exefile>.o

// then run

./<exefile>.o

```

or
    
```bash

gcc <srcfilename>.c -o <exefile>.exe // for windows

// then run

./<exefile>.exe

```



è¯¥éƒ¨åˆ†è½¬è‡ªä»¥ä¸‹é“¾æ¥ï¼š
[ğŸ”— GCCåŸºæœ¬ä½¿ç”¨](https://zhuanlan.zhihu.com/p/404682058)

---------------------------------- I GCC å·¥å…· ----------------------------------

> GCC ç¼–è¯‘å™¨

GCCï¼ˆGNU Compiler Collectionï¼‰æ˜¯ç”± GNU å¼€å‘çš„ç¼–ç¨‹è¯­è¨€ç¼–è¯‘å™¨ã€‚ GCCæœ€åˆä»£è¡¨â€œGNU C Compilerâ€ï¼Œå½“æ—¶åªæ”¯æŒCè¯­è¨€ã€‚ åæ¥åˆæ‰©å±•èƒ½å¤Ÿæ”¯æŒæ›´å¤šç¼–ç¨‹è¯­è¨€ï¼ŒåŒ…æ‹¬ C++ã€Fortran å’Œ Java ç­‰ã€‚ å› æ­¤ï¼ŒGCCä¹Ÿè¢«é‡æ–°å®šä¹‰ä¸ºâ€œGNU Compiler Collectionâ€ï¼Œæˆä¸ºå†å²ä¸Šæœ€ä¼˜ç§€çš„ç¼–è¯‘å™¨ï¼Œ å…¶æ‰§è¡Œæ•ˆç‡ä¸ä¸€èˆ¬çš„ç¼–è¯‘å™¨ç›¸æ¯”å¹³å‡æ•ˆç‡è¦é«˜ 20%~30%ã€‚

> GCC ç¼–è¯‘å·¥å…·é“¾

GCCç¼–è¯‘å·¥å…·é“¾ï¼ˆtoolchainï¼‰ï¼Œæ˜¯æŒ‡ä»¥GCCç¼–è¯‘å™¨ä¸ºæ ¸å¿ƒçš„ä¸€æ•´å¥—å·¥å…·ã€‚å®ƒä¸»è¦åŒ…å«ä»¥ä¸‹ä¸‰éƒ¨åˆ†å†…å®¹ï¼š

- gcc-coreï¼šå³GCCç¼–è¯‘å™¨ï¼Œç”¨äºå®Œæˆé¢„å¤„ç†å’Œç¼–è¯‘è¿‡ç¨‹ï¼ŒæŠŠCä»£ç è½¬æ¢æˆæ±‡ç¼–ä»£ç ã€‚
- Binutils ï¼šé™¤GCCç¼–è¯‘å™¨å¤–çš„ä¸€ç³»åˆ—å°å·¥å…·åŒ…æ‹¬äº†é“¾æ¥å™¨ldï¼Œæ±‡ç¼–å™¨asã€ç›®æ ‡æ–‡ä»¶æ ¼å¼æŸ¥çœ‹å™¨readelfç­‰ã€‚
- glibcï¼šåŒ…å«äº†ä¸»è¦çš„ Cè¯­è¨€æ ‡å‡†å‡½æ•°åº“ï¼ŒCè¯­è¨€ä¸­å¸¸å¸¸ä½¿ç”¨çš„æ‰“å°å‡½æ•°printfã€mallocå‡½æ•°å°±åœ¨glibc åº“ä¸­ã€‚
åœ¨å¾ˆå¤šåœºåˆä¸‹ä¼šç›´æ¥ç”¨GCCç¼–è¯‘å™¨æ¥æŒ‡ä»£æ•´å¥—GCCç¼–è¯‘å·¥å…·é“¾ã€‚

> Binutilså·¥å…·é›†

Binutilsï¼ˆbin utilityï¼‰ï¼Œæ˜¯GNUäºŒè¿›åˆ¶å·¥å…·é›†ï¼Œé€šå¸¸è·ŸGCCç¼–è¯‘å™¨ä¸€èµ·æ‰“åŒ…å®‰è£…åˆ°ç³»ç»Ÿï¼Œå®ƒçš„å®˜æ–¹è¯´æ˜ç½‘ç«™åœ°å€ä¸ºï¼š https://www.gnu.org/software/binutils/ ã€‚

åœ¨è¿›è¡Œç¨‹åºå¼€å‘çš„æ—¶å€™é€šå¸¸ä¸ä¼šç›´æ¥è°ƒç”¨è¿™äº›å·¥å…·ï¼Œè€Œæ˜¯åœ¨ä½¿ç”¨GCCç¼–è¯‘æŒ‡ä»¤çš„æ—¶å€™ç”±GCCç¼–è¯‘å™¨é—´æ¥è°ƒç”¨ã€‚ä¸‹é¢æ˜¯å…¶ä¸­ä¸€äº›å¸¸ç”¨çš„å·¥å…·ï¼š

- asï¼šæ±‡ç¼–å™¨ï¼ŒæŠŠæ±‡ç¼–è¯­è¨€ä»£ç è½¬æ¢ä¸ºæœºå™¨ç ï¼ˆç›®æ ‡æ–‡ä»¶ï¼‰ã€‚
- ldï¼šé“¾æ¥å™¨ï¼ŒæŠŠç¼–è¯‘ç”Ÿæˆçš„å¤šä¸ªç›®æ ‡æ–‡ä»¶ç»„ç»‡æˆæœ€ç»ˆçš„å¯æ‰§è¡Œç¨‹åºæ–‡ä»¶ã€‚
- readelfï¼šå¯ç”¨äºæŸ¥çœ‹ç›®æ ‡æ–‡ä»¶æˆ–å¯æ‰§è¡Œç¨‹åºæ–‡ä»¶çš„ä¿¡æ¯ã€‚
- nm ï¼š å¯ç”¨äºæŸ¥çœ‹ç›®æ ‡æ–‡ä»¶ä¸­å‡ºç°çš„ç¬¦å·ã€‚
- objcopyï¼š å¯ç”¨äºç›®æ ‡æ–‡ä»¶æ ¼å¼è½¬æ¢ï¼Œå¦‚.bin è½¬æ¢æˆ .elf ã€.elf è½¬æ¢æˆ .binç­‰ã€‚
- objdumpï¼šå¯ç”¨äºæŸ¥çœ‹ç›®æ ‡æ–‡ä»¶çš„ä¿¡æ¯ï¼Œæœ€ä¸»è¦çš„ä½œç”¨æ˜¯åæ±‡ç¼–ã€‚
- sizeï¼šå¯ç”¨äºæŸ¥çœ‹ç›®æ ‡æ–‡ä»¶ä¸åŒéƒ¨åˆ†çš„å°ºå¯¸å’Œæ€»å°ºå¯¸ï¼Œä¾‹å¦‚ä»£ç æ®µå¤§å°ã€æ•°æ®æ®µå¤§å°ã€ä½¿ç”¨çš„é™æ€å†…å­˜ã€æ€»å¤§å°ç­‰ã€‚

> glibcåº“

glibcåº“æ˜¯GNUç»„ç»‡ä¸ºGNUç³»ç»Ÿä»¥åŠLinuxç³»ç»Ÿç¼–å†™çš„Cè¯­è¨€æ ‡å‡†åº“ï¼Œå› ä¸ºç»å¤§éƒ¨åˆ†Cç¨‹åºéƒ½ä¾èµ–è¯¥å‡½æ•°åº“ï¼Œè¯¥æ–‡ä»¶ç”šè‡³ä¼šç›´æ¥å½±å“åˆ°ç³»ç»Ÿçš„æ­£å¸¸è¿è¡Œï¼Œä¾‹å¦‚å¸¸ç”¨çš„æ–‡ä»¶æ“ä½œå‡½æ•°readã€writeã€openï¼Œæ‰“å°å‡½æ•°printfã€åŠ¨æ€å†…å­˜ç”³è¯·å‡½æ•°mallocç­‰ã€‚

---------------------------------- II GCC ç¼–è¯‘ ----------------------------------

> GCC ç¼–è¯‘è¿‡ç¨‹

GCC ç¼–è¯‘å·¥å…·é“¾åœ¨ç¼–è¯‘ä¸€ä¸ªCæºæ–‡ä»¶æ—¶éœ€è¦ç»è¿‡ä»¥ä¸‹ 4 æ­¥ï¼š

- é¢„å¤„ç†ï¼šä¸ºæŠŠå¤´æ–‡ä»¶çš„ä»£ç ã€å®ä¹‹ç±»çš„å†…å®¹è½¬æ¢æˆç”Ÿæˆçš„.iæ–‡ä»¶ï¼Œè¿˜æ˜¯Cä»£ç ã€‚
- ç¼–è¯‘ï¼šæŠŠé¢„å¤„ç†åçš„.iæ–‡ä»¶é€šè¿‡ç¼–è¯‘æˆ.sæ–‡ä»¶ï¼Œæ±‡ç¼–è¯­è¨€ã€‚
- æ±‡ç¼–ï¼šå°†æ±‡ç¼–è¯­è¨€æ–‡ä»¶ç”Ÿæˆç›®æ ‡æ–‡ä»¶.oæ–‡ä»¶ï¼Œæœºå™¨ç ã€‚
- é“¾æ¥ï¼šå°†æ¯ä¸ªæºæ–‡ä»¶å¯¹åº”çš„.oæ–‡ä»¶é“¾æ¥èµ·æ¥ï¼Œå°±ç”Ÿæˆä¸€ä¸ªå¯æ‰§è¡Œç¨‹åºæ–‡ä»¶ã€‚

![COMPILE-PROCESS](COMPLIE-PROCESS.jpg ':size=50%')

> (1) é¢„å¤„ç†

é¢„å¤„ç†è¿‡ç¨‹ä¸­ï¼Œå¯¹æºä»£ç æ–‡ä»¶ä¸­çš„æ–‡ä»¶åŒ…å« (include)ã€ é¢„ç¼–è¯‘è¯­å¥ (å¦‚å®å®šä¹‰defineç­‰)è¿›è¡Œå±•å¼€ï¼Œç”Ÿæˆ .i æ–‡ä»¶ã€‚ å¯ç†è§£ä¸ºæŠŠå¤´æ–‡ä»¶çš„ä»£ç ã€å®ä¹‹ç±»çš„å†…å®¹è½¬æ¢æˆæ›´çº¯ç²¹çš„Cä»£ç ï¼Œä¸è¿‡ç”Ÿæˆçš„æ–‡ä»¶ä»¥.iä¸ºåç¼€ã€‚

ä½¿ç”¨GCCçš„å‚æ•° â€œ-Eâ€ï¼Œå¯ä»¥è®©ç¼–è¯‘å™¨ç”Ÿæˆ .i æ–‡ä»¶ï¼Œå‚æ•° â€œ-oâ€ï¼Œå¯ä»¥æŒ‡å®šè¾“å‡ºæ–‡ä»¶çš„åå­—ã€‚

```bash
# é¢„å¤„ç†ï¼Œå¯ç†è§£ä¸ºæŠŠå¤´æ–‡ä»¶çš„ä»£ç æ±‡æ€»æˆCä»£ç ï¼ŒæŠŠ*.cè½¬æ¢å¾—åˆ°*.iæ–‡ä»¶
gcc -E hello.c -o hello.i
```

ç›¸å½“äºå®ƒæŠŠåŸCä»£ç ä¸­åŒ…å«çš„å¤´æ–‡ä»¶ä¸­å¼•ç”¨çš„å†…å®¹æ±‡æ€»åˆ°ä¸€å¤„ï¼Œ å¦‚æœåŸCä»£ç æœ‰å®å®šä¹‰ï¼Œå®ƒæŠŠå®å®šä¹‰å±•å¼€æˆå…·ä½“çš„å†…å®¹ã€‚

> (2) ç¼–è¯‘

æŠŠé¢„å¤„ç†åçš„.iæ–‡ä»¶é€šè¿‡ç¼–è¯‘æˆä¸ºæ±‡ç¼–è¯­è¨€ï¼Œç”Ÿæˆ.sæ–‡ä»¶ï¼Œå³æŠŠä»£ç ä»Cè¯­è¨€è½¬æ¢æˆæ±‡ç¼–è¯­è¨€ï¼Œè¿™æ˜¯GCCç¼–è¯‘å™¨å®Œæˆçš„å·¥ä½œã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ï¼ŒGCCä¼šæ£€æŸ¥å„ä¸ªæºæ–‡ä»¶çš„è¯­æ³•ï¼Œå³ä½¿æˆ‘ä»¬è°ƒç”¨äº†ä¸€ä¸ªæ²¡æœ‰å®šä¹‰çš„å‡½æ•°ï¼Œä¹Ÿä¸ä¼šæŠ¥é”™ã€‚

GCCå¯ä»¥ä½¿ç”¨-Sé€‰é¡¹ï¼Œè®©ç¼–è¯‘ç¨‹åºç”Ÿæˆæ±‡ç¼–è¯­è¨€çš„ä»£ç æ–‡ä»¶ï¼ˆ.såç¼€ï¼‰ã€‚

```bash
# ç¼–è¯‘ï¼Œå¯ç†è§£ä¸ºæŠŠCä»£ç è½¬æ¢ä¸ºæ±‡ç¼–ä»£ç ï¼ŒæŠŠ*.iè½¬æ¢å¾—åˆ°*.sæ–‡ä»¶
gcc â€“S hello.i â€“o hello.s
â€‹
# ä¹Ÿå¯ä»¥ç›´æ¥ä»¥Cæ–‡ä»¶ä½œä¸ºè¾“å…¥è¿›è¡Œç¼–è¯‘ï¼Œä¸ä¸Šé¢çš„å‘½ä»¤æ˜¯ç­‰ä»·çš„
gcc â€“S hello.c â€“o hello.s
```

> (3) æ±‡ç¼–

å°†æ±‡ç¼–è¯­è¨€æ–‡ä»¶ç»è¿‡æ±‡ç¼–ï¼Œç”Ÿæˆç›®æ ‡æ–‡ä»¶.oæ–‡ä»¶ï¼Œæ¯ä¸€ä¸ªæºæ–‡ä»¶éƒ½å¯¹åº”ä¸€ä¸ªç›®æ ‡æ–‡ä»¶ã€‚å³æŠŠæ±‡ç¼–è¯­è¨€çš„ä»£ç è½¬æ¢æˆæœºå™¨ç ï¼Œè¿™æ˜¯asæ±‡ç¼–å™¨å®Œæˆçš„å·¥ä½œã€‚

GCCçš„å‚æ•°â€œcâ€è¡¨ç¤ºåªç¼–è¯‘(compile)æºæ–‡ä»¶ä½†ä¸é“¾æ¥ï¼Œä¼šå°†æºç¨‹åºç¼–è¯‘æˆç›®æ ‡æ–‡ä»¶ï¼ˆ.oåç¼€ï¼‰ã€‚è®¡ç®—æœºåªè®¤è¯†0æˆ–è€…1ï¼Œä¸æ‡‚å¾—Cè¯­è¨€ï¼Œä¹Ÿä¸æ‡‚å¾—æ±‡ç¼–è¯­è¨€ï¼Œç»è¿‡ç¼–è¯‘æ±‡ç¼–ä¹‹åï¼Œç”Ÿæˆçš„ç›®æ ‡æ–‡ä»¶åŒ…å«ç€æœºå™¨ä»£ç ï¼Œè¿™éƒ¨åˆ†ä»£ç å°±å¯ä»¥ç›´æ¥è¢«è®¡ç®—æœºæ‰§è¡Œã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨å‚æ•°â€œcâ€ï¼Œè·³è¿‡ä¸Šè¿°çš„ä¸¤ä¸ªè¿‡ç¨‹ï¼Œå…·ä½“å‘½ä»¤ å¦‚ä¸‹ï¼š

```bash
# æ±‡ç¼–ï¼Œå¯ç†è§£ä¸ºæŠŠæ±‡ç¼–ä»£ç è½¬æ¢ä¸ºæœºå™¨ç ï¼ŒæŠŠ*.sè½¬æ¢å¾—åˆ°*.oï¼Œå³ç›®æ ‡æ–‡ä»¶
gcc â€“c hello.s â€“o hello.o
â€‹
# ä¹Ÿå¯ä»¥ç›´æ¥ä»¥Cæ–‡ä»¶ä½œä¸ºè¾“å…¥è¿›è¡Œæ±‡ç¼–ï¼Œä¸ä¸Šé¢çš„å‘½ä»¤æ˜¯ç­‰ä»·çš„
gcc â€“c hello.c â€“o hello.o
```

Linuxä¸‹ç”Ÿæˆçš„ *.oç›®æ ‡æ–‡ä»¶ã€*soåŠ¨æ€åº“æ–‡ä»¶ä»¥åŠä¸‹ä¸€å°èŠ‚é“¾æ¥é˜¶æ®µç”Ÿæˆæœ€ç»ˆçš„å¯æ‰§è¡Œæ–‡ä»¶éƒ½æ˜¯elfæ ¼å¼çš„ï¼Œ å¯ä»¥ä½¿ç”¨â€œreadelfâ€å·¥å…·æ¥æŸ¥çœ‹å®ƒä»¬çš„å†…å®¹ã€‚

ä» readelf çš„å·¥å…·è¾“å‡ºçš„ä¿¡æ¯ï¼Œå¯ä»¥äº†è§£åˆ°ç›®æ ‡æ–‡ä»¶åŒ…å«ELFå¤´ã€ç¨‹åºå¤´ã€èŠ‚ç­‰å†…å®¹ï¼Œ å¯¹äº*.oç›®æ ‡æ–‡ä»¶æˆ–*.soåº“æ–‡ä»¶ï¼Œç¼–è¯‘å™¨åœ¨é“¾æ¥é˜¶æ®µåˆ©ç”¨è¿™äº›ä¿¡æ¯æŠŠå¤šä¸ªæ–‡ä»¶ç»„ç»‡èµ·æ¥ï¼Œ å¯¹äºå¯æ‰§è¡Œæ–‡ä»¶ï¼Œç³»ç»Ÿåœ¨è¿è¡Œæ—¶æ ¹æ®è¿™äº›ä¿¡æ¯åŠ è½½ç¨‹åºè¿è¡Œã€‚

> (4) é“¾æ¥

æœ€åå°†æ¯ä¸ªæºæ–‡ä»¶å¯¹åº”çš„ç›®æ ‡.oæ–‡ä»¶é“¾æ¥èµ·æ¥ï¼Œå°±ç”Ÿæˆä¸€ä¸ªå¯æ‰§è¡Œç¨‹åºæ–‡ä»¶ï¼Œè¿™æ˜¯é“¾æ¥å™¨ldå®Œæˆçš„å·¥ä½œã€‚

ä¾‹å¦‚ä¸€ä¸ªå·¥ç¨‹é‡ŒåŒ…å«äº†Aå’ŒBä¸¤ä¸ªä»£ç æ–‡ä»¶ï¼Œåœ¨é“¾æ¥é˜¶æ®µï¼Œ é“¾æ¥è¿‡ç¨‹éœ€è¦æŠŠAå’ŒBä¹‹é—´çš„å‡½æ•°è°ƒç”¨å…³ç³»ç†é¡ºï¼Œä¹Ÿå°±æ˜¯è¯´è¦å‘Šè¯‰Aåœ¨å“ªé‡Œèƒ½å¤Ÿè°ƒç”¨åˆ°funå‡½æ•°ï¼Œ å»ºç«‹æ˜ å°„å…³ç³»ï¼Œæ‰€ä»¥ç§°ä¹‹ä¸ºé“¾æ¥ã€‚è‹¥é“¾æ¥è¿‡ç¨‹ä¸­æ‰¾ä¸åˆ°funå‡½æ•°çš„å…·ä½“å®šä¹‰ï¼Œåˆ™ä¼šé“¾æ¥æŠ¥é”™ã€‚

è™½ç„¶æœ¬ç¤ºä¾‹åªæœ‰ä¸€ä¸ªhello.cæ–‡ä»¶ï¼Œä½†å®ƒè°ƒç”¨äº†Cæ ‡å‡†ä»£ç åº“çš„printfå‡½æ•°ï¼Œ æ‰€ä»¥é“¾æ¥å™¨ä¼šæŠŠå®ƒå’Œprintfå‡½æ•°é“¾æ¥èµ·æ¥ï¼Œç”Ÿæˆæœ€ç»ˆçš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚

é“¾æ¥åˆ†ä¸ºä¸¤ç§ï¼š

- åŠ¨æ€é“¾æ¥ï¼šGCCç¼–è¯‘æ—¶çš„é»˜è®¤é€‰é¡¹ã€‚åŠ¨æ€æ˜¯æŒ‡åœ¨åº”ç”¨ç¨‹åºè¿è¡Œæ—¶æ‰å»åŠ è½½å¤–éƒ¨çš„ä»£ç åº“ï¼Œä¸åŒçš„ç¨‹åºå¯ä»¥å…±ç”¨ä»£ç åº“ã€‚ æ‰€ä»¥åŠ¨æ€é“¾æ¥ç”Ÿæˆçš„ç¨‹åºæ¯”è¾ƒå°ï¼Œå ç”¨è¾ƒå°‘çš„å†…å­˜ã€‚

- é™æ€é“¾æ¥ï¼šé“¾æ¥æ—¶ä½¿ç”¨é€‰é¡¹ â€œ--staticâ€ï¼Œå®ƒåœ¨ç¼–è¯‘é˜¶æ®µå°±ä¼šæŠŠæ‰€æœ‰ç”¨åˆ°çš„åº“æ‰“åŒ…åˆ°è‡ªå·±çš„å¯æ‰§è¡Œç¨‹åºä¸­ã€‚ æ‰€ä»¥é™æ€é“¾æ¥çš„ä¼˜ç‚¹æ˜¯å…·æœ‰è¾ƒå¥½çš„å…¼å®¹æ€§ï¼Œä¸ä¾èµ–å¤–éƒ¨ç¯å¢ƒï¼Œä½†æ˜¯ç”Ÿæˆçš„ç¨‹åºæ¯”è¾ƒå¤§ã€‚
æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ä½“éªŒé™æ€é“¾æ¥ä¸åŠ¨æ€é“¾æ¥çš„åŒºåˆ«ï¼š

```bash
# åœ¨hello.oæ‰€åœ¨çš„ç›®å½•æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤
# åŠ¨æ€é“¾æ¥ï¼Œç”Ÿæˆåä¸ºhelloçš„å¯æ‰§è¡Œæ–‡ä»¶
â€‹
gcc hello.o â€“o hello
â€‹
# ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨Cæ–‡ä»¶ä¸€æ­¥ç”Ÿæˆï¼Œä¸ä¸Šé¢çš„å‘½ä»¤ç­‰ä»·
gcc hello.c -o hello
â€‹
# é™æ€é“¾æ¥ï¼Œä½¿ç”¨--staticå‚æ•°ï¼Œç”Ÿæˆåä¸ºhello_staticçš„å¯æ‰§è¡Œæ–‡ä»¶
gcc hello.o â€“o hello_static --static
â€‹
# ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨Cæ–‡ä»¶ä¸€æ­¥ç”Ÿæˆï¼Œä¸ä¸Šé¢çš„å‘½ä»¤ç­‰ä»·
gcc hello.c -o hello_static --static
```

---------------------------------- III äº¤å‰ç¼–è¯‘ ----------------------------------

å¦‚æœæˆ‘ä»¬å¸Œæœ›ç¼–è¯‘å™¨è¿è¡Œåœ¨x86æ¶æ„å¹³å°ä¸Šï¼Œç„¶åç¼–è¯‘ç”ŸæˆARMæ¶æ„çš„å¯æ‰§è¡Œç¨‹åºï¼Œè¿™ç§ç¼–è¯‘å™¨å’Œç›®æ ‡ç¨‹åºè¿è¡Œåœ¨ä¸åŒæ¶æ„çš„ç¼–è¯‘è¿‡ç¨‹ï¼Œè¢«ç§°ä¸º äº¤å‰ç¼–è¯‘ã€‚

> ï¼ˆ1ï¼‰å®‰è£…ARM-GCC

```bash
# åœ¨ä¸»æœºä¸Šæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤
sudo apt install gcc-arm-linux-gnueabihf
â€‹
# å®‰è£…å®Œæˆåä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹ç‰ˆæœ¬
arm-linux-gnueabihf-gcc â€“v
```

> ï¼ˆ2ï¼‰äº¤å‰ç¼–è¯‘

äº¤å‰ç¼–è¯‘å™¨ä¸æœ¬åœ°ç¼–è¯‘å™¨ä½¿ç”¨èµ·æ¥å¹¶æ²¡æœ‰å¤šå¤§åŒºåˆ«ã€‚

```bash
# åœ¨hello.cç¨‹åºæ‰€åœ¨çš„ç›®å½•æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤
arm-linux-gnueabihf-gcc hello.c â€“o hello_arm
```

åŒæ ·çš„Cä»£ç æ–‡ä»¶ï¼Œä½¿ç”¨äº¤å‰ç¼–è¯‘å™¨ç¼–è¯‘åï¼Œç”Ÿæˆçš„helloå·²ç»å˜æˆäº†ARMå¹³å°çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¯ä»¥é€šè¿‡readelfå·¥å…·æ¥æŸ¥çœ‹å…·ä½“çš„ç¨‹åºä¿¡æ¯ã€‚

readelfå·¥å…·åœ¨ç³»ç»Ÿå®‰è£…GCCç¼–è¯‘å·¥å…·é“¾æ—¶ä¸€èµ·è¢«å®‰è£…äº†ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚åœ¨ä¸»æœºä¸Šæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```bash
# ä»¥ä¸‹å‘½ä»¤åœ¨ä¸»æœºä¸Šè¿è¡Œ
readelf -a hello_arm
```

æœ€åæŠŠhello_armé€šè¿‡NFSæ‹·è´åˆ°å¼€å‘æ¿ä¸Šï¼Œå°±èƒ½æ‰‹åŠ¨è¿è¡Œäº†ã€‚

> ï¼ˆ3ï¼‰GCCç¼–è¯‘å™¨å‘½åæ ¼å¼

é™¤äº†æˆ‘ä»¬å®‰è£…çš„arm-linux-gnueabihf-gccå¤–ï¼Œç¼–è¯‘å™¨è¿˜æœ‰å¾ˆå¤šç‰ˆæœ¬ï¼Œå¦‚arm-linux-gnueabi-gccï¼Œæœ¬åœ°ç¼–è¯‘å™¨gccå…¨åä¸ºx86_64-linux-gnu-gccï¼Œè¿™äº›ç¼–è¯‘å™¨æ˜¯æœ‰ä¸€å®šçš„å‘½åè§„åˆ™çš„ï¼š

arch [-os] [-(gnu)eabi(hf)] -gcc

å…¶ä¸­çš„å„å­—æ®µå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š

![CROSS-COMPILER](CROSS-COMPILER.jpg ':size=50%')

ä»¥æˆ‘ä»¬å®‰è£…çš„arm-linux-gnueabihf-gccç¼–è¯‘å™¨ä¸ºä¾‹ï¼š

- armï¼šè¡¨ç¤ºå®ƒçš„ç›®æ ‡èŠ¯ç‰‡æ¶æ„ä¸ºARM
- linuxï¼šç›®æ ‡æ“ä½œç³»ç»Ÿä¸ºLinux
- gnuï¼šä½¿ç”¨GNUçš„Cæ ‡å‡†åº“å³glibc
- eabiï¼šä½¿ç”¨åµŒå…¥å¼åº”ç”¨äºŒè¿›åˆ¶æ¥å£ï¼ˆeabiï¼‰
- hfï¼šç¼–è¯‘å™¨çš„æµ®ç‚¹æ¨¡å¼ä¸ºç¡¬æµ®ç‚¹hard-float

### G++

ä¸GCCç±»ä¼¼ï¼ŒG++æ˜¯GCCçš„C++ç¼–è¯‘å™¨ï¼Œå®ƒçš„ç¼–è¯‘è¿‡ç¨‹ä¸GCCç±»ä¼¼ï¼Œåªæ˜¯åœ¨ç¼–è¯‘é˜¶æ®µä¼šè°ƒç”¨C++çš„ç¼–è¯‘å™¨g++ï¼Œåœ¨é“¾æ¥é˜¶æ®µä¼šè°ƒç”¨C++çš„é“¾æ¥å™¨g++ã€‚

```bash
# ä½¿ç”¨ g++ ç¼–è¯‘ C++ ä»£ç ç¤ºä¾‹

## 1. ç¼–è¯‘å•ä¸ªæºæ–‡ä»¶ï¼š

g++ source.cpp -o output

## 2. ç¼–è¯‘å¤šä¸ªæºæ–‡ä»¶ï¼š

g++ source1.cpp source2.cpp -o output

## 3. æŒ‡å®šC++æ ‡å‡†ï¼š

g++ -std=c++11 source.cpp -o output

## 4.æ·»åŠ è°ƒè¯•ä¿¡æ¯

g++ -g source.cpp -o output

## 5.æŒ‡å®šè¾“å‡ºç›®å½•

g++ source.cpp -o build/output

## 6.é“¾æ¥å¤–éƒ¨åº“

g++ source.cpp -o output -llibrary

## 7.æŒ‡å®šå¤´æ–‡ä»¶ç›®å½•

g++ -I/path/to/headers source.cpp -o output

## 8.æ˜¾ç¤ºç¼–è¯‘è¿‡ç¨‹è¯¦ç»†ä¿¡æ¯

g++ -v source.cpp -o output

```


### Clang

å¾…æ›´æ–°

### Make & Makefile

ä»¥ä¸‹éƒ¨åˆ†è½¬è‡ªä»¥ä¸‹é“¾æ¥ï¼š
[ğŸ”— Makefileå…¥é—¨(è¶…è¯¦ç»†ä¸€æ–‡è¯»æ‡‚)](https://zhuanlan.zhihu.com/p/575852387)

> 1 Makefileç¼–è¯‘è¿‡ç¨‹

![MAKE-PROCESS](MAKE-PROCESS.jpg ':size=50%')

Makefileæ–‡ä»¶ä¸­çš„å‘½ä»¤æœ‰ä¸€å®šè§„èŒƒï¼Œä¸€æ—¦è¯¥æ–‡ä»¶ç¼–å†™å¥½ä»¥ååœ¨Linuxå‘½ä»¤è¡Œä¸­æ‰§è¡Œä¸€æ¡makeå‘½ä»¤å³å¯è‡ªåŠ¨ç¼–è¯‘æ•´ä¸ªå·¥ç¨‹ã€‚ä¸åŒå‚å®¶çš„makeå¯èƒ½ä¼šç¨æœ‰ä¸åŒï¼Œå¹¶ä¸”è¯­æ³•ä¸Šä¹Ÿæœ‰åŒºåˆ«ï¼Œä¸è¿‡åŸºæœ¬æ€æƒ³éƒ½å·®ä¸å¤šï¼Œä¸»è¦è¿˜æ˜¯è½åœ¨ç›®æ ‡ä¾èµ–ä¸Šï¼Œæœ€å¹¿æ³›ä½¿ç”¨çš„æ˜¯GNUmakeã€‚

> 2 è¯­æ³•è§„åˆ™

```bash
ç›®æ ‡ ... : ä¾èµ– ...
	å‘½ä»¤1
	å‘½ä»¤2
	. . .

```

Makefileçš„æ ¸å¿ƒè§„åˆ™ï¼Œç±»ä¼¼äºä¸€ä½å¨ç¥åšèœï¼Œç›®æ ‡å°±æ˜¯åšå¥½ä¸€é“èœï¼Œé‚£ä¹ˆæ‰€è°“çš„ä¾èµ–å°±æ˜¯å„ç§é£Ÿæï¼Œå„ç§å¨å…·ç­‰ç­‰ï¼Œç„¶åéœ€è¦å¨å¸ˆå¥½çš„æŠ€æœ¯æ–¹æ³•ç±»ä¼¼äºå‘½ä»¤ï¼Œæ‰èƒ½ä½œå‡ºä¸€é“å¥½èœã€‚

åŒæ—¶è¿™äº›ä¾èµ–ä¹Ÿæœ‰å¯èƒ½æ­¤æ—¶å¹¶ä¸å­˜åœ¨ï¼Œéœ€è¦ç°åœºåˆ¶ä½œï¼Œæˆ–è€…æ˜¯ç”±å…¶ä»–å¨å¸ˆåšå¥½ï¼Œé‚£ä¹ˆè¿™ä¸ªä¾èµ–å°±æˆä¸ºäº†å…¶ä»–è§„åˆ™çš„ç›®æ ‡ï¼Œè¯¥ç›®æ ‡ä¹Ÿä¼šæœ‰ä»–è‡ªå·±çš„ä¾èµ–å’Œå‘½ä»¤ã€‚è¿™æ ·å°±å½¢æˆäº†ä¸€å±‚ä¸€å±‚é€’å½’ä¾èµ–ç»„æˆäº†Makefileæ–‡ä»¶ã€‚

Makefileå¹¶ä¸ä¼šå…³å¿ƒå‘½ä»¤æ˜¯å¦‚ä½•æ‰§è¡Œçš„ï¼Œä»…ä»…åªæ˜¯ä¼šå»æ‰§è¡Œæ‰€æœ‰å®šä¹‰çš„å‘½ä»¤ï¼Œå’Œæˆ‘ä»¬å¹³æ—¶ç›´æ¥è¾“å…¥å‘½ä»¤è¡Œæ˜¯ä¸€æ ·çš„æ•ˆæœã€‚

1. ç›®æ ‡å³è¦ç”Ÿæˆçš„æ–‡ä»¶ã€‚å¦‚æœç›®æ ‡æ–‡ä»¶çš„æ›´æ–°æ—¶é—´æ™šäºä¾èµ–æ–‡ä»¶æ›´æ–°æ—¶é—´ï¼Œåˆ™è¯´æ˜ä¾èµ–æ–‡ä»¶æ²¡æœ‰æ”¹åŠ¨ï¼Œç›®æ ‡æ–‡ä»¶ä¸éœ€è¦é‡æ–°ç¼–è¯‘ã€‚å¦åˆ™ä¼šè¿›è¡Œé‡æ–°ç¼–è¯‘å¹¶æ›´æ–°ç›®æ ‡æ–‡ä»¶ã€‚
2. é»˜è®¤æƒ…å†µä¸‹Makefileçš„ç¬¬ä¸€ä¸ªç›®æ ‡ä¸ºç»ˆæç›®æ ‡ã€‚
3. ä¾èµ–ï¼šå³ç›®æ ‡æ–‡ä»¶ç”±å“ªäº›æ–‡ä»¶ç”Ÿæˆã€‚
4. å‘½ä»¤ï¼šå³é€šè¿‡æ‰§è¡Œå‘½ä»¤ç”±ä¾èµ–æ–‡ä»¶ç”Ÿæˆç›®æ ‡æ–‡ä»¶ã€‚æ³¨æ„æ¯æ¡å‘½ä»¤ä¹‹å‰å¿…é¡»æœ‰ä¸€ä¸ªtabä¿æŒç¼©è¿›ï¼Œè¿™æ˜¯è¯­æ³•è¦æ±‚ï¼ˆä¼šæœ‰ä¸€äº›ç¼–è¾‘å·¥å…·é»˜è®¤tabä¸º4ä¸ªç©ºæ ¼ï¼Œä¼šé€ æˆMakefileè¯­æ³•é”™è¯¯ï¼‰ã€‚
5. allï¼šMakefileæ–‡ä»¶é»˜è®¤åªç”Ÿæˆç¬¬ä¸€ä¸ªç›®æ ‡æ–‡ä»¶å³å®Œæˆç¼–è¯‘ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡all æŒ‡å®šæ‰€éœ€è¦ç”Ÿæˆçš„ç›®æ ‡æ–‡ä»¶ã€‚


> 3 å˜é‡

\$ç¬¦å·è¡¨ç¤ºå–å˜é‡çš„å€¼ï¼Œå½“å˜é‡åå¤šäºä¸€ä¸ªå­—ç¬¦æ—¶ï¼Œä½¿ç”¨"( )"
\$ç¬¦çš„å…¶ä»–ç”¨æ³•

\$^ è¡¨ç¤ºæ‰€æœ‰çš„ä¾èµ–æ–‡ä»¶

\$@ è¡¨ç¤ºç”Ÿæˆçš„ç›®æ ‡æ–‡ä»¶

\$< ä»£è¡¨ç¬¬ä¸€ä¸ªä¾èµ–æ–‡ä»¶


```bash
SRC = $(wildcard *.c)
OBJ = $(patsubst %.c, %.o, $(SRC))
 
ALL: hello.out
 
hello.out: $(OBJ)
        gcc $< -o $@
 
$(OBJ): $(SRC)
        gcc -c $< -o $@
        
```

> 4 å˜é‡èµ‹å€¼

1ã€"="æ˜¯æœ€æ™®é€šçš„ç­‰å·ï¼Œåœ¨Makefileä¸­å®¹æ˜“æé”™èµ‹å€¼ç­‰å·ï¼Œä½¿ç”¨ â€œ=â€è¿›è¡Œèµ‹å€¼ï¼Œå˜é‡çš„å€¼æ˜¯æ•´ä¸ªMakefileä¸­æœ€åè¢«æŒ‡å®šçš„å€¼ã€‚

```bash
VIR_A = A
VIR_B = $(VIR_A) B
VIR_A = AA
```

ç»è¿‡ä¸Šé¢çš„èµ‹å€¼åï¼Œæœ€åVIR_Bçš„å€¼æ˜¯AA Bï¼Œè€Œä¸æ˜¯A Bï¼Œåœ¨makeæ—¶ï¼Œä¼šæŠŠæ•´ä¸ªMakefileå±•å¼€ï¼Œæ¥å†³å®šå˜é‡çš„å€¼


2ã€":=" è¡¨ç¤ºç›´æ¥èµ‹å€¼ï¼Œèµ‹äºˆå½“å‰ä½ç½®çš„å€¼ã€‚

```bash
VIR_A := A
VIR_B := $(VIR_A) B
VIR_A := AA

```

æœ€åBIR_Bçš„å€¼æ˜¯A Bï¼Œå³æ ¹æ®å½“å‰ä½ç½®è¿›è¡Œèµ‹å€¼ã€‚å› æ­¤ç›¸å½“äºâ€œ=â€ï¼Œâ€œï¼š=â€æ‰æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„ç›´æ¥èµ‹å€¼

3ã€"?=" è¡¨ç¤ºå¦‚æœè¯¥å˜é‡æ²¡æœ‰è¢«èµ‹å€¼ï¼Œèµ‹å€¼äºˆç­‰å·åé¢çš„å€¼ã€‚

```bash
VIR ?= new_value
```
å¦‚æœVIRåœ¨ä¹‹å‰æ²¡æœ‰è¢«èµ‹å€¼ï¼Œé‚£ä¹ˆVIRçš„å€¼å°±ä¸ºnew_valueã€‚

```bash
VIR := old_value
VIR ?= new_value
```
è¿™ç§æƒ…å†µä¸‹ï¼ŒVIRçš„å€¼å°±æ˜¯old_value

4ã€"+="å’Œå¹³æ—¶å†™ä»£ç çš„ç†è§£æ˜¯ä¸€æ ·çš„ï¼Œè¡¨ç¤ºå°†ç¬¦å·åé¢çš„å€¼æ·»åŠ åˆ°å‰é¢çš„å˜é‡ä¸Š

> 5 é¢„å®šä¹‰å˜é‡

CCï¼šcç¼–è¯‘å™¨çš„åç§°ï¼Œé»˜è®¤å€¼ä¸ºccã€‚cpp cé¢„ç¼–è¯‘å™¨çš„åç§°é»˜è®¤å€¼ä¸º$(CC) -E

```bash
CC = gcc
```

å›æ˜¾é—®é¢˜ï¼ŒMakefileä¸­çš„å‘½ä»¤éƒ½ä¼šè¢«æ‰“å°å‡ºæ¥ã€‚å¦‚æœä¸æƒ³æ‰“å°å‘½ä»¤éƒ¨åˆ† å¯ä»¥ä½¿ç”¨@å»é™¤å›æ˜¾

```bash
@echo "clean done!"
```

> 6 å‡½æ•°

é€šé…ç¬¦

```bash
SRC = $(wildcard ./*.c)
```
åŒ¹é…ç›®å½•ä¸‹æ‰€æœ‰.c æ–‡ä»¶ï¼Œå¹¶å°†å…¶èµ‹å€¼ç»™SRCå˜é‡ã€‚
```bash
OBJ = $(patsubst %.c, %.o, $(SRC))
```
è¿™ä¸ªå‡½æ•°æœ‰ä¸‰ä¸ªå‚æ•°ï¼Œæ„æ€æ˜¯å–å‡ºSRCä¸­çš„æ‰€æœ‰å€¼ï¼Œç„¶åå°†.c æ›¿æ¢ä¸º.o æœ€åèµ‹å€¼ç»™OBJå˜é‡ã€‚
ç¤ºä¾‹ï¼šå¦‚æœç›®å½•ä¸‹æœ‰å¾ˆå¤šä¸ª.c æºæ–‡ä»¶ï¼Œå°±ä¸éœ€è¦å†™å¾ˆå¤šæ¡è§„åˆ™è¯­å¥äº†ï¼Œè€Œæ˜¯å¯ä»¥åƒä¸‹é¢è¿™æ ·å†™
```bash
SRC = $(wildcard *.c)
OBJ = $(patsubst %.c, %.o, $(SRC))
 
ALL: hello.out
 
hello.out: $(OBJ)
        gcc $(OBJ) -o hello.out
 
$(OBJ): $(SRC)
        gcc -c $(SRC) -o $(OBJ)
```

è¿™é‡Œå…ˆå°†æ‰€æœ‰.c æ–‡ä»¶ç¼–è¯‘ä¸º .o æ–‡ä»¶ï¼Œè¿™æ ·åé¢æ›´æ”¹æŸä¸ª .c æ–‡ä»¶æ—¶ï¼Œå…¶ä»–çš„ .c æ–‡ä»¶å°†ä¸åœ¨ç¼–è¯‘ï¼Œè€Œåªæ˜¯ç¼–è¯‘æœ‰æ›´æ”¹çš„ .c æ–‡ä»¶ï¼Œå¯ä»¥å¤§å¤§æé«˜å¤§é¡¹ç›®ä¸­çš„ç¼–è¯‘é€Ÿåº¦ã€‚

> 7 ä¼ªç›®æ ‡ .PHONY

ä¼ªç›®æ ‡åªæ˜¯ä¸€ä¸ªæ ‡ç­¾ï¼Œcleanæ˜¯ä¸ªä¼ªç›®æ ‡æ²¡æœ‰ä¾èµ–æ–‡ä»¶ï¼Œåªæœ‰ç”¨makeæ¥è°ƒç”¨æ—¶æ‰ä¼šæ‰§è¡Œ

å½“ç›®å½•ä¸‹æœ‰ä¸make å‘½ä»¤ åŒåçš„æ–‡ä»¶æ—¶ æ‰§è¡Œmake å‘½ä»¤å°±ä¼šå‡ºç°é”™è¯¯ã€‚

è§£å†³åŠæ³•å°±æ˜¯ä½¿ç”¨ä¼ªç›®æ ‡
```bash
SRC = $(wildcard *.c)
OBJ = $(patsubst %.c, %.o, $(SRC))
 
ALL: hello.out
 
hello.out: $(OBJ)
        gcc $< -o $@
 
$(OBJ): $(SRC)
        gcc -c $< -o $@
 
clean:
        rm -rf $(OBJ) hello.out
 
.PHONY: clean ALL
```
é€šå¸¸ä¹Ÿä¼šæŠŠALLè®¾ç½®æˆä¼ªç›®æ ‡

> 8 å…¶ä»–å¸¸ç”¨åŠŸèƒ½

ä»£ç æ¸…ç†clean
æˆ‘ä»¬å¯ä»¥ç¼–è¯‘ä¸€æ¡å±äºè‡ªå·±çš„cleanè¯­å¥ï¼Œæ¥æ¸…ç†makeå‘½ä»¤æ‰€äº§ç”Ÿçš„æ‰€æœ‰æ–‡ä»¶ï¼Œåˆ—å¦‚

```bash
SRC = $(wildcard *.c)
OBJ = $(patsubst %.c, %.o, $(SRC))
 
ALL: hello.out
 
hello.out: $(OBJ)
        gcc $< -o $@
 
$(OBJ): $(SRC)
        gcc -c $< -o $@
 
clean:
        rm -rf $(OBJ) hello.out
```

> 9 åµŒå¥—æ‰§è¡ŒMakefile

åœ¨ä¸€äº›å¤§å·¥ç¨‹ä¸­ï¼Œä¼šæŠŠä¸åŒæ¨¡å—æˆ–ä¸åŒåŠŸèƒ½çš„æºæ–‡ä»¶æ”¾åœ¨ä¸åŒçš„ç›®å½•ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ¯ä¸ªç›®å½•ä¸­éƒ½å†™ä¸€ä¸ªè¯¥ç›®å½•çš„Makefileè¿™æœ‰åˆ©äºè®©æˆ‘ä»¬çš„Makefileå˜çš„æ›´åŠ ç®€æ´ï¼Œä¸è‡³äºæŠŠæ‰€æœ‰ä¸œè¥¿å…¨éƒ¨å†™åœ¨ä¸€ä¸ªMakefileä¸­ã€‚

åˆ—å¦‚åœ¨å­ç›®å½•subdirç›®å½•ä¸‹æœ‰ä¸ªMakefileæ–‡ä»¶ï¼Œæ¥æŒ‡æ˜è¿™ä¸ªç›®å½•ä¸‹æ–‡ä»¶çš„ç¼–è¯‘è§„åˆ™ã€‚å¤–éƒ¨æ€»Makefileå¯ä»¥è¿™æ ·å†™

```bash
subsystem:
            cd subdir && $(MAKE)
å…¶ç­‰ä»·äºï¼š
subsystem:
            $(MAKE) -C subdir

```
å®šä¹‰$(MAKE)å®å˜é‡çš„æ„æ€æ˜¯ï¼Œä¹Ÿè®¸æˆ‘ä»¬çš„makeéœ€è¦ä¸€äº›å‚æ•°ï¼Œæ‰€ä»¥å®šä¹‰æˆä¸€ä¸ªå˜é‡æ¯”è¾ƒæœ‰åˆ©äºç»´æŠ¤ã€‚ä¸¤ä¸ªä¾‹å­æ„æ€éƒ½æ˜¯å…ˆè¿›å…¥"subdir"ç›®å½•ï¼Œç„¶åæ‰§è¡Œmakeå‘½ä»¤

æˆ‘ä»¬æŠŠè¿™ä¸ªMakefileå«åšæ€»æ§Makefileï¼Œæ€»æ§Makefileçš„å˜é‡å¯ä»¥ä¼ é€’åˆ°ä¸‹çº§çš„Makefileä¸­ï¼Œä½†æ˜¯ä¸ä¼šè¦†ç›–ä¸‹å±‚Makefileä¸­æ‰€å®šä¹‰çš„å˜é‡ï¼Œé™¤éæŒ‡å®šäº† "-e"å‚æ•°ã€‚

å¦‚æœä¼ é€’å˜é‡åˆ°ä¸‹çº§Makefileä¸­ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨è¿™æ ·çš„å£°æ˜

export

å¦‚æœä¸æƒ³è®©æŸäº›å˜é‡ä¼ é€’åˆ°ä¸‹çº§Makefileï¼Œå¯ä»¥ä½¿ç”¨

unexport

```bash
export variable = value

ç­‰ä»·äº

variable = value
export variable

ç­‰ä»·äº

export variable := value

ç­‰ä»·äº

variable := value
export variable

å¦‚æœéœ€è¦ä¼ é€’æ‰€æœ‰å˜é‡ï¼Œé‚£ä¹ˆåªè¦ä¸€ä¸ªexportå°±è¡Œäº†ã€‚åé¢ä»€ä¹ˆä¹Ÿä¸ç”¨è·Ÿï¼Œè¡¨ç¤ºä¼ é€’æ‰€æœ‰å˜é‡
```

> 10 æŒ‡å®šå¤´æ–‡ä»¶è·¯å¾„

ä¸€èˆ¬éƒ½æ˜¯é€šè¿‡"-I"ï¼ˆå¤§å†™iï¼‰æ¥æŒ‡å®šï¼Œå‡è®¾å¤´æ–‡ä»¶åœ¨ï¼š

```bash
/home/develop/include
```
åˆ™å¯ä»¥é€šè¿‡-IæŒ‡å®šï¼š
```bash
-I/home/develop/include
```
å°†è¯¥ç›®å½•æ·»åŠ åˆ°å¤´æ–‡ä»¶æœç´¢è·¯å¾„ä¸­

åœ¨Makefileä¸­åˆ™å¯ä»¥è¿™æ ·å†™ï¼š
```bash
CFLAGS=-I/home/develop/include
```
ç„¶ååœ¨ç¼–è¯‘çš„æ—¶å€™ï¼Œå¼•ç”¨CFLAGSå³å¯ï¼Œå¦‚ä¸‹
```bash
yourapp:*.c
    gcc $(CFLAGS) -o yourapp
```

> 11 æŒ‡å®šåº“æ–‡ä»¶è·¯å¾„

ä¸ä¸Šé¢æŒ‡å®šå¤´æ–‡ä»¶ç±»ä¼¼åªä¸è¿‡ä½¿ç”¨çš„æ˜¯"-L"æ¥æŒ‡å®š

```bash
LDFLAGS=-L/usr/lib -L/path/to/your/lib
```
å‘Šè¯‰é“¾æ¥å™¨è¦é“¾æ¥å“ªäº›åº“æ–‡ä»¶ï¼Œä½¿ç”¨"-l"ï¼ˆå°å†™Lï¼‰å¦‚ä¸‹ï¼š

```bash
LIBS = -lpthread -liconv
```

> 12 ç®€å•çš„Makefileå®ä¾‹

![MAKEEXAMPLE](MAKEEXAMPLE.png ':size=50%')

- include
  - myinclude.h

```C
#include <stdio.h>
void print1() ;
void print2() ;

```

- f1
  - f1.c
  - Makefile

```C
#include "../include/myinclude.h"                                                                              

void print1()  
{  
	printf("Message f1.c\n");  
	return;  
} 
```

ç›®æ ‡å‰é¢çš„è·¯å¾„ï¼Œæ„æ€æ˜¯å°†ç›®æ ‡ç”Ÿæˆåˆ°æŒ‡å®šçš„ç›®å½•ä¸‹

```bash
../$(OBJS_DIR)/f1.o:f1.c                                                                                       
	@$(CC) -c $^ -o $@  
```

- f2
  - f2.c
  - Makefile

```C
#include "../include/myinclude.h"                                                                              

void print2()  
{  
	printf("Message f2.c\n");  
	return;  
} 
```

ç›®æ ‡å‰é¢çš„è·¯å¾„ï¼Œæ„æ€æ˜¯å°†ç›®æ ‡ç”Ÿæˆåˆ°æŒ‡å®šçš„ç›®å½•ä¸‹

```bash
../$(OBJS_DIR)/f2.o:f2.c                                                                                       
	@$(CC) -c $^ -o $@  
```

- main
  - main.c
  - Makefile

```C
#include "../include/myinclude.h"                                                                                            
 
int main(int argc, char const *argv[])
{
    print1();  
	print2();  
    return 0;
}
```

```bash
../$(OBJS_DIR)/main.o:main.c                                                                                   
	@$(CC) -c $^ -o $@  
```

- obj
  - Makefile

this folder is used to store the object files

```bash
../$(BIN_DIR)/$(BIN) : $(OBJS)
	@$(CC) $^ -o $@ 
```

- Makefile ï¼ˆä¸»ï¼‰

```bash
#é¢„å®šä¹‰å˜é‡
CC = gcc
#é¢„å®šä¹‰ç¼–è¯‘ç›®å½•
SUBDIRS = f1 \
        f2 \
        main \
        obj
#é¢„å®šä¹‰ç›®æ ‡
OBJS = f1.o f2.o main.o
BIN = myapp
OBJS_DIR = obj
BIN_DIR = bin
#ä¼ é€’é¢„å®šä¹‰å‚æ•°
export CC OBJS BIN OBJS_DIR BIN_DIR

all:CHECK_DIR $(SUBDIRS)
CHECK_DIR:
	@mkdir -p $(BIN_DIR)
$(SUBDIRS):ECHO
	@make -C $@ 

ECHO:
	@echo $(SUBDIRS)
	@echo begin compile
clean:
	@$(RM) $(OBJS_DIR)/*.o
	@rm -rf $(BIN_DIR)
```

- bin (ç”¨æ¥å­˜æ”¾å¯æ‰§è¡Œæ–‡ä»¶)

### CMake & CMakeLists.txt

### Ninja

### XMake